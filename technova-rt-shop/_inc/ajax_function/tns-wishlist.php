<?phpadd_action('wp_ajax_tns_wishlist','tns_wishlist');function tns_wishlist() {	if ( !is_user_logged_in() ) {		wp_send_json( [ 'error' => true, 'message' => 'لطفا اول وارد شوید!!' ], 403 );	}	if ( ! isset( $_POST['nonce'] ) || ! wp_verify_nonce( $_POST['nonce'] ) ) {		die( 'access denied' );	}	global $wpdb;	$table = $wpdb-> prefix . 'tns_wishlist' ;	$p_id = intval($_POST['product_id']);	$u_id = get_current_user_id();	$p_title = get_the_title($p_id);	$p_thumbnail = get_the_post_thumbnail_url($p_id);	$p_permalink = get_the_permalink($p_id);	// بررسی اینکه آیا این بوکمارک قبلاً ثبت شده یا نه	$exists = $wpdb->get_var($wpdb->prepare(		"SELECT COUNT(*) FROM {$table} WHERE u_id = %d AND p_id = %d",		$u_id, $p_id	));	if ( $exists ) {		$deleted = $wpdb->delete(			$table,			['u_id' => $u_id, 'p_id' => $p_id],			['%d', '%d']		);		if ( $deleted ) {			wp_send_json(['success' => true, 'message' => 'محصول از لیست علاقه‌مندی‌ها حذف شد.'], 200);		} else {			wp_send_json(['error' => true, 'message' => 'خطا در حذف اطلاعات!'], 500);		}     }else {	     $data = [		     'p_id'        => $p_id,		     'u_id'        => $u_id,		     'p_title'     => $p_title,		     'p_thumbnail' => $p_thumbnail,		     'p_permalink' => $p_permalink	     ];	     $format = ['%d', '%d', '%s', '%s', '%s'];	     $stmt = $wpdb->insert($table,$data , $format);	     if ($stmt){		     wp_send_json(['success'=>true,'message'=>'محصول به لیست علاقه مندی ها اضافه شد!'],200);	     }else{		     wp_send_json(['error' => true, 'message' => 'خطا در درج داده است! '], 403);	     }     }}function tns_user_bookmark_product($user_id , $product_id): bool {	global $wpdb;	$table = $wpdb-> prefix . 'tns_wishlist' ;	$stmt  = $wpdb->get_row($wpdb->prepare("SELECT u_id , p_id FROM {$table} WHERE u_id='%d' AND p_id='%d'",$user_id,$product_id));	if ($stmt){		return true;	}else{		return false;	}}